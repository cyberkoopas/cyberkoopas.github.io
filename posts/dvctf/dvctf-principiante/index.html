<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Principiante | CyberKoopas</title>
<meta name="keywords" content="x-DaVinciCTF, programming">
<meta name="description" content="Challenge information Summary You have to give the correct answer 12 times in a row with a 1s timeout between each answer. Base keyboard is :
_____________________________ | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |_| |_| | |_| |_| |_| | | | | | | | | | | | | | | | | | |___|___|___|___|___|___|___| Examples of expected answers :">
<meta name="author" content="

">
<link rel="canonical" href="https://www.cyberkoopas.fr/posts/dvctf/dvctf-principiante/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css" integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://www.cyberkoopas.fr/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.cyberkoopas.fr/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.cyberkoopas.fr/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.cyberkoopas.fr/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.cyberkoopas.fr/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="Principiante" />
<meta property="og:description" content="Challenge information Summary You have to give the correct answer 12 times in a row with a 1s timeout between each answer. Base keyboard is :
_____________________________ | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |_| |_| | |_| |_| |_| | | | | | | | | | | | | | | | | | |___|___|___|___|___|___|___| Examples of expected answers :" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.cyberkoopas.fr/posts/dvctf/dvctf-principiante/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-11T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-03-11T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Principiante"/>
<meta name="twitter:description" content="Challenge information Summary You have to give the correct answer 12 times in a row with a 1s timeout between each answer. Base keyboard is :
_____________________________ | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |_| |_| | |_| |_| |_| | | | | | | | | | | | | | | | | | |___|___|___|___|___|___|___| Examples of expected answers :"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.cyberkoopas.fr/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Principiante",
      "item": "https://www.cyberkoopas.fr/posts/dvctf/dvctf-principiante/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Principiante",
  "name": "Principiante",
  "description": "Challenge information Summary You have to give the correct answer 12 times in a row with a 1s timeout between each answer. Base keyboard is :\n_____________________________ | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |_| |_| | |_| |_| |_| | | | | | | | | | | | | | | | | | |___|___|___|___|___|___|___| Examples of expected answers :",
  "keywords": [
    "x-DaVinciCTF", "programming"
  ],
  "articleBody": "Challenge information Summary You have to give the correct answer 12 times in a row with a 1s timeout between each answer. Base keyboard is :\n_____________________________ | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |_| |_| | |_| |_| |_| | | | | | | | | | | | | | | | | | |___|___|___|___|___|___|___| Examples of expected answers :\nGive me the 4th A# plz _________________________________________________________________________________________________________________ | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |X| | | |_| |_| | |_| |_| |_| | |_| |_| | |_| |_| |_| | |_| |_| | |_| |_| |_| | |_| |_| | |_| |_| |_| | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___| Give me the 2nd F plz _________________________________________________________ | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |_| |_| | |_| |_| |_| | |_| |_| | |_| |_| |_| | | | | | | | | | | | | | | | | | | | | | | | | | | | X | | | | |___|___|___|___|___|___|___|___|___|___|___|___|___|___| Connection info: nc prog.dvc.tf 7751\nSolution Script creation The aim of this challenge is to create the keyboard corresponding to the requested note. Python is an appropried programming language for this challenge, we’ll use it. Firstly we create the keyboard template and the associated notes with their position.\nbase = [ \"____________________________\", \"| | | | | | | | | | | | \", \"| | | | | | | | | | | | \", \"| | | | | | | | | | | | \", \"| |_| |_| | |_| |_| |_| \", \"| | | | | | | \", \"| | | | | | | \", \"|___|___|___|___|___|___|___\" ] key_dict = { \"C\": 27, \"D\": 23, \"E\": 19, \"F\": 15, \"G\": 11, \"A\": 7, \"B\": 3, \"C#\": 25, \"D#\": 21, \"F#\": 13, \"G#\": 9, \"A#\": 5 } Then we have to code the connection to the remote challenge. We create a function netcat(hostname, port) to communicate with the challenge. We make a socket connection and then read data to create the corresponding keyboard.\nimport socket def netcat(hostname, port): # Connect to remote challenge s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((hostname, port)) while 1: # Read data data = s.recv(1024) if len(data) == 0: break response = repr(data.decode(\"utf-8\")) print(\"Received:\", response) # Make the answer res = get_res(response) print(res) # Send the answer s.sendall(str.encode(res)) print(\"Connection closed.\") s.close() # Run script netcat('prog.dvc.tf',7751) We can see to make the answer, the function get_res() is called. This function will solve the challenge request. \\\nNotice that the server send us a string like that:\nn° 1\\nGive me the 4th F plz\\n Let’s write this function and decompose it in 3 steps :\nParse the challenge request data. Check if the note contains the # char. Create the keyboard and put the X on the correct position. From the challenge request, we need to extract the number of keyboard to create and the note to place. To get the number of duplicate keyboard, we split the challenge request on \\n and on space .\ndef get_res(response): string = response.split('\\\\n')[1] # Get note note = string.split(' ')[4] # Get number of keyboard to duplicate duplicate = int(string.split(' ')[3][:-2]) Then we need to get the note and create keyboard. We can identify note position thanks to our key_dict variable and if it’s on the top or bottom of the keyboard thanks to the # char.\noffset = key_dict[note] is_up = True if note[len(note)-1] == \"#\" else False Finally, create our keyboard based on previous variables :\n# First line msg = base[0]*duplicate+\"_\\n\" # Print all other lines for i in range(1,8): line = base[i]*duplicate+\"|\" # if note with '#', place the 'X' on the top of keyboard if (is_up and i == 3): line = line[:len(line)-offset] + \"X\" + line[len(line)-offset + 1:] # if note doesn't contains '#', place the 'X' on the bottom of keyboard elif (not is_up and i == 6): line = line[:len(line)-offset] + \"X\" + line[len(line)-offset + 1:] msg += line + \"\\n\" return msg Final script #! /usr/bin/python3 import socket base = [ \"____________________________\", \"| | | | | | | | | | | | \", \"| | | | | | | | | | | | \", \"| | | | | | | | | | | | \", \"| |_| |_| | |_| |_| |_| \", \"| | | | | | | \", \"| | | | | | | \", \"|___|___|___|___|___|___|___\" ] key_dict = { \"C\": 27, \"D\": 23, \"E\": 19, \"F\": 15, \"G\": 11, \"A\": 7, \"B\": 3, \"C#\": 25, \"D#\": 21, \"F#\": 13, \"G#\": 9, \"A#\": 5 } def get_res(response): string = response.split('\\\\n')[1] note = string.split(' ')[4] duplicate = int(string.split(' ')[3][:-2]) is_up = True if note[len(note)-1] == \"#\" else False offset = key_dict[note] msg = base[0]*duplicate+\"_\\n\" for i in range(1,8): line = base[i]*duplicate+\"|\" if (is_up and i == 3): line = line[:len(line)-offset] + \"X\" + line[len(line)-offset + 1:] elif (not is_up and i == 6): line = line[:len(line)-offset] + \"X\" + line[len(line)-offset + 1:] msg += line + \"\\n\" return msg def netcat(hostname, port): s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((hostname, port)) while 1: data = s.recv(1024) if len(data) == 0: break response = repr(data.decode(\"utf-8\")) print(\"Received:\", response) res = get_res(response) print(res) s.sendall(str.encode(res)) print(\"Connection closed.\") s.close() netcat('prog.dvc.tf',7751) ",
  "wordCount" : "1182",
  "inLanguage": "en",
  "datePublished": "2023-03-11T00:00:00Z",
  "dateModified": "2023-03-11T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "CyberKoopas"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.cyberkoopas.fr/posts/dvctf/dvctf-principiante/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "CyberKoopas",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.cyberkoopas.fr/favicon.ico"
    }
  }
}
</script>
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.cyberkoopas.fr/" accesskey="h" title="CyberKoopas (Alt + H)">
                <img src="https://www.cyberkoopas.fr/avatar.jpeg" alt="" aria-label="logo"
                    height="30">CyberKoopas</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.cyberkoopas.fr/timeline/" title="Timeline">
                    <span>Timeline</span>
                </a>
            </li>
            <li>
                <a href="https://www.cyberkoopas.fr/categories/writeups/" title="Writeups">
                    <span>Writeups</span>
                </a>
            </li>
            <li>
                <a href="https://www.cyberkoopas.fr/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://www.cyberkoopas.fr/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Principiante
    </h1>
    <div class="post-meta"><span title='2023-03-11 00:00:00 +0000 UTC'>March 11, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;



</div>
  </header> 
  <div class="post-content"><h2 id="challenge-information">Challenge information<a hidden class="anchor" aria-hidden="true" href="#challenge-information">#</a></h2>
<h3 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h3>
<p>You have to give the correct answer 12 times in a row with a 1s timeout between each answer.  <br>
Base keyboard is :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>_____________________________
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |
</span></span><span style="display:flex;"><span>|  |_| |_|  |  |_| |_| |_|  |
</span></span><span style="display:flex;"><span>|   |   |   |   |   |   |   |
</span></span><span style="display:flex;"><span>|   |   |   |   |   |   |   |
</span></span><span style="display:flex;"><span>|___|___|___|___|___|___|___|
</span></span></code></pre></div><p>Examples of expected answers :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Give me the 4th A# plz
</span></span><span style="display:flex;"><span>_________________________________________________________________________________________________________________
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |  | | | |  |  | | | | |X|  |
</span></span><span style="display:flex;"><span>|  |_| |_|  |  |_| |_| |_|  |  |_| |_|  |  |_| |_| |_|  |  |_| |_|  |  |_| |_| |_|  |  |_| |_|  |  |_| |_| |_|  |
</span></span><span style="display:flex;"><span>|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |
</span></span><span style="display:flex;"><span>|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |
</span></span><span style="display:flex;"><span>|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|___|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Give me the 2nd F plz
</span></span><span style="display:flex;"><span>_________________________________________________________
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |
</span></span><span style="display:flex;"><span>|  | | | |  |  | | | | | |  |  | | | |  |  | | | | | |  |
</span></span><span style="display:flex;"><span>|  |_| |_|  |  |_| |_| |_|  |  |_| |_|  |  |_| |_| |_|  |
</span></span><span style="display:flex;"><span>|   |   |   |   |   |   |   |   |   |   |   |   |   |   |
</span></span><span style="display:flex;"><span>|   |   |   |   |   |   |   |   |   |   | X |   |   |   |
</span></span><span style="display:flex;"><span>|___|___|___|___|___|___|___|___|___|___|___|___|___|___|
</span></span></code></pre></div><p>Connection info: <code>nc prog.dvc.tf 7751</code></p>
<h2 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h2>
<h3 id="script-creation">Script creation<a hidden class="anchor" aria-hidden="true" href="#script-creation">#</a></h3>
<p>The aim of this challenge is to create the keyboard corresponding to the requested note.  <br>
Python is an appropried programming language for this challenge, we&rsquo;ll use it.
Firstly we create the keyboard template and the associated notes with their position.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>base <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;____________________________&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|  | | | |  |  | | | | | |  &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|  | | | |  |  | | | | | |  &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|  | | | |  |  | | | | | |  &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|  |_| |_|  |  |_| |_| |_|  &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|   |   |   |   |   |   |   &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|   |   |   |   |   |   |   &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|___|___|___|___|___|___|___&#34;</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>key_dict <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;C&#34;</span>: <span style="color:#ae81ff">27</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;D&#34;</span>: <span style="color:#ae81ff">23</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;E&#34;</span>: <span style="color:#ae81ff">19</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;F&#34;</span>: <span style="color:#ae81ff">15</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;G&#34;</span>: <span style="color:#ae81ff">11</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;A&#34;</span>: <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;B&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;C#&#34;</span>: <span style="color:#ae81ff">25</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;D#&#34;</span>: <span style="color:#ae81ff">21</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;F#&#34;</span>: <span style="color:#ae81ff">13</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;G#&#34;</span>: <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;A#&#34;</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Then we have to code the connection to the remote challenge. We create a function <em>netcat(hostname, port)</em> to communicate with the challenge.  <br>
We make a socket connection and then read data to create the corresponding keyboard.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> socket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">netcat</span>(hostname, port):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Connect to remote challenge</span>
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET, socket<span style="color:#f92672">.</span>SOCK_STREAM)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>connect((hostname, port))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Read data</span>
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(data) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> repr(data<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;utf-8&#34;</span>))
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Received:&#34;</span>, response)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Make the answer</span>
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> get_res(response)
</span></span><span style="display:flex;"><span>        print(res)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Send the answer</span>
</span></span><span style="display:flex;"><span>        s<span style="color:#f92672">.</span>sendall(str<span style="color:#f92672">.</span>encode(res))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Connection closed.&#34;</span>)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Run script</span>
</span></span><span style="display:flex;"><span>netcat(<span style="color:#e6db74">&#39;prog.dvc.tf&#39;</span>,<span style="color:#ae81ff">7751</span>)
</span></span></code></pre></div><p>We can see to make the answer, the function <code>get_res()</code> is called. This function will solve the challenge request.  \</p>
<p>Notice that the server send us a string like that:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>n° 1\nGive me the 4th F plz\n
</span></span></code></pre></div><p>Let&rsquo;s write this function and decompose it in 3 steps :</p>
<ol>
<li>Parse the challenge request data.</li>
<li>Check if the note contains the <code>#</code> char.</li>
<li>Create the keyboard and put the <code>X</code> on the correct position.</li>
</ol>
<p>From the challenge request, we need to extract the number of keyboard to create and the note to place.  <br>
To get the number of duplicate keyboard, we split the challenge request on <code>\n</code> and on space <code> </code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_res</span>(response):
</span></span><span style="display:flex;"><span>    string <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">n&#39;</span>)[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get note</span>
</span></span><span style="display:flex;"><span>    note <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39; &#39;</span>)[<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get number of keyboard to duplicate</span>
</span></span><span style="display:flex;"><span>    duplicate <span style="color:#f92672">=</span> int(string<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39; &#39;</span>)[<span style="color:#ae81ff">3</span>][:<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>])
</span></span></code></pre></div><p>Then we need to get the note and create keyboard. We can identify note position thanks to our <code>key_dict</code> variable and if it&rsquo;s on the top or bottom of the keyboard thanks to the <code>#</code> char.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    offset <span style="color:#f92672">=</span> key_dict[note]
</span></span><span style="display:flex;"><span>    is_up <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span> <span style="color:#66d9ef">if</span> note[len(note)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;#&#34;</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">False</span>
</span></span></code></pre></div><p>Finally, create our keyboard based on previous variables  :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#75715e"># First line</span>
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> base[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>duplicate<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Print all other lines</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>        line <span style="color:#f92672">=</span> base[i]<span style="color:#f92672">*</span>duplicate<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;|&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># if note with &#39;#&#39;, place the &#39;X&#39; on the top of keyboard</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (is_up <span style="color:#f92672">and</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            line <span style="color:#f92672">=</span> line[:len(line)<span style="color:#f92672">-</span>offset] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;X&#34;</span> <span style="color:#f92672">+</span> line[len(line)<span style="color:#f92672">-</span>offset <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>:]
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># if note doesn&#39;t contains &#39;#&#39;, place the &#39;X&#39; on the bottom of keyboard</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> (<span style="color:#f92672">not</span> is_up <span style="color:#f92672">and</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>):
</span></span><span style="display:flex;"><span>            line <span style="color:#f92672">=</span> line[:len(line)<span style="color:#f92672">-</span>offset] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;X&#34;</span> <span style="color:#f92672">+</span> line[len(line)<span style="color:#f92672">-</span>offset <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>:]
</span></span><span style="display:flex;"><span>        msg <span style="color:#f92672">+=</span> line <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> msg
</span></span></code></pre></div><h3 id="final-script">Final script<a hidden class="anchor" aria-hidden="true" href="#final-script">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#! /usr/bin/python3</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> socket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>base <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;____________________________&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|  | | | |  |  | | | | | |  &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|  | | | |  |  | | | | | |  &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|  | | | |  |  | | | | | |  &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|  |_| |_|  |  |_| |_| |_|  &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|   |   |   |   |   |   |   &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|   |   |   |   |   |   |   &#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;|___|___|___|___|___|___|___&#34;</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>key_dict <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;C&#34;</span>: <span style="color:#ae81ff">27</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;D&#34;</span>: <span style="color:#ae81ff">23</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;E&#34;</span>: <span style="color:#ae81ff">19</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;F&#34;</span>: <span style="color:#ae81ff">15</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;G&#34;</span>: <span style="color:#ae81ff">11</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;A&#34;</span>: <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;B&#34;</span>: <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;C#&#34;</span>: <span style="color:#ae81ff">25</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;D#&#34;</span>: <span style="color:#ae81ff">21</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;F#&#34;</span>: <span style="color:#ae81ff">13</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;G#&#34;</span>: <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;A#&#34;</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_res</span>(response):
</span></span><span style="display:flex;"><span>    string <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">n&#39;</span>)[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    note <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39; &#39;</span>)[<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>    duplicate <span style="color:#f92672">=</span> int(string<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39; &#39;</span>)[<span style="color:#ae81ff">3</span>][:<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    is_up <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span> <span style="color:#66d9ef">if</span> note[len(note)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;#&#34;</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    offset <span style="color:#f92672">=</span> key_dict[note]
</span></span><span style="display:flex;"><span>    msg <span style="color:#f92672">=</span> base[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>duplicate<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;_</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>        line <span style="color:#f92672">=</span> base[i]<span style="color:#f92672">*</span>duplicate<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;|&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (is_up <span style="color:#f92672">and</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            line <span style="color:#f92672">=</span> line[:len(line)<span style="color:#f92672">-</span>offset] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;X&#34;</span> <span style="color:#f92672">+</span> line[len(line)<span style="color:#f92672">-</span>offset <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>:]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> (<span style="color:#f92672">not</span> is_up <span style="color:#f92672">and</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>):
</span></span><span style="display:flex;"><span>            line <span style="color:#f92672">=</span> line[:len(line)<span style="color:#f92672">-</span>offset] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;X&#34;</span> <span style="color:#f92672">+</span> line[len(line)<span style="color:#f92672">-</span>offset <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>:]
</span></span><span style="display:flex;"><span>        msg <span style="color:#f92672">+=</span> line <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> msg
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">netcat</span>(hostname, port):
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET, socket<span style="color:#f92672">.</span>SOCK_STREAM)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>connect((hostname, port))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(data) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> repr(data<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;utf-8&#34;</span>))
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Received:&#34;</span>, response)
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> get_res(response)
</span></span><span style="display:flex;"><span>        print(res)
</span></span><span style="display:flex;"><span>        s<span style="color:#f92672">.</span>sendall(str<span style="color:#f92672">.</span>encode(res))
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Connection closed.&#34;</span>)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>netcat(<span style="color:#e6db74">&#39;prog.dvc.tf&#39;</span>,<span style="color:#ae81ff">7751</span>)
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.cyberkoopas.fr/tags/x-davincictf/">x-DaVinciCTF</a></li>
      <li><a href="https://www.cyberkoopas.fr/tags/programming/">programming</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; CyberKoopas | 2023</span>
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
